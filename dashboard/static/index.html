<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knowledge Engine - Dashboard</title>
    <link rel="icon" type="image/png" href="/dashboard/static/favicon.png">
    <link rel="stylesheet" href="/dashboard/static/css/dashboard.css">
</head>
<body>
    <div class="container">
        <!-- Left: Theme navigation and search -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1 class="app-title">Knowledge Engine</h1>
            </div>

            <div class="search-box">
                <input
                    type="text"
                    id="search-input"
                    placeholder="Search insights..."
                    class="search-input"
                >
                <button id="search-clear" class="search-clear" title="Clear search">âœ•</button>
                <div class="search-mode-toggle">
                    <label class="toggle-pill">
                        <input type="checkbox" id="semantic-toggle" checked>
                        <span class="toggle-label">By meaning</span>
                    </label>
                </div>
            </div>

            <div id="search-results" class="search-results" style="display: none;">
                <div class="search-results-header">
                    <span id="search-results-count" class="search-results-count"></span>
                    <span id="search-results-mode" class="search-results-mode"></span>
                </div>
                <div id="search-results-list" class="search-results-list"></div>
            </div>

            <div class="embedding-index-status">
                <span id="index-status-text" class="index-status-text"></span>
                <button id="build-index-btn" class="btn-build-index" style="display: none;">Build Index</button>
            </div>

            <div class="themes-section">
                <h2 class="section-title">Themes</h2>
                <div id="theme-nav" class="theme-list"></div>
            </div>

            <div class="actions-section">
                <button id="refresh-btn" class="btn-refresh">
                    <span class="btn-icon">â†»</span>
                    Refresh Vault
                </button>
                <div id="refresh-status" class="refresh-status"></div>
            </div>

            <div class="sidebar-footer">
                <p class="stats">
                    <span id="total-insights">0</span> insights
                </p>
            </div>
        </aside>

        <!-- Center: Graph visualization -->
        <main class="graph-container">
            <div class="graph-header">
                <div class="view-controls">
                    <button id="zoom-in" class="btn-control" title="Zoom in">+</button>
                    <button id="zoom-out" class="btn-control" title="Zoom out">âˆ’</button>
                    <button id="reset-view" class="btn-control" title="Reset view">âŠ™</button>
                </div>
                <div id="graph-stats" class="graph-stats"></div>
            </div>
            <svg id="knowledge-graph"></svg>
            <div id="graph-loading" class="loading-indicator">
                <div class="spinner"></div>
                <p>Loading knowledge graph...</p>
            </div>
        </main>

        <!-- Right: Insight viewer -->
        <section class="viewer">
            <div class="viewer-empty">
                <p>Select an insight to view details</p>
            </div>

            <div id="insight-detail" class="insight-detail" style="display: none;">
                <div class="insight-header">
                    <h2 id="insight-title" class="insight-title"></h2>
                    <button id="close-insight" class="btn-close" title="Close">âœ•</button>
                </div>

                <div class="insight-metadata">
                    <div class="metadata-row">
                        <span class="metadata-label">Theme</span>
                        <span id="insight-theme" class="metadata-value"></span>
                    </div>
                    <div class="metadata-row">
                        <span class="metadata-label">Novelty</span>
                        <div class="novelty-display">
                            <span id="insight-novelty-stars" class="novelty-stars"></span>
                            <span id="insight-novelty-score" class="novelty-score"></span>
                        </div>
                    </div>
                    <div class="metadata-row">
                        <span class="metadata-label">Date</span>
                        <span id="insight-date" class="metadata-value"></span>
                    </div>
                    <div class="metadata-row" id="source-row">
                        <span class="metadata-label">Source</span>
                        <span id="insight-source" class="metadata-value"></span>
                    </div>
                </div>

                <div id="insight-concepts" class="concepts-section" style="display: none;">
                    <h3 class="section-title">Concepts</h3>
                    <div id="concepts-list" class="tag-list"></div>
                </div>

                <div id="insight-tags" class="tags-section" style="display: none;">
                    <h3 class="section-title">Tags</h3>
                    <div id="tags-list" class="tag-list"></div>
                </div>

                <div class="insight-actions">
                    <button id="copy-link" class="btn-secondary" title="Copy link">
                        <span class="btn-icon">ðŸ”—</span>
                        Copy Link
                    </button>
                </div>

                <div id="insight-content" class="insight-content"></div>
            </div>
        </section>
    </div>

    <!-- Scripts -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="/dashboard/static/js/graph.js"></script>
    <script src="/dashboard/static/js/sidebar.js"></script>
    <script src="/dashboard/static/js/viewer.js"></script>
    <script src="/dashboard/static/js/main.js"></script>
</body>
</html>